{% extends 'admin_base.html' %}
{% block title %}Analisar Solicitação de Cadastro{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0 text-gray-800">Análise de Solicitação de Cadastro</h1>
        <a href="{{ url_for('admin_analisar_solicitacoes') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Voltar para a Lista
        </a>
    </div>

    <!-- Ações Administrativas -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Ações Administrativas</h6>
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('admin_atualizar_status', empresa_id=empresa.id) }}">
                <div class="row align-items-end">
                    <div class="col-md-4">
                        <p class="mb-1"><strong>Status atual:</strong> <span class="badge bg-warning text-dark">{{ empresa.status }}</span></p>
                    </div>
                    <div class="col-md-4">
                        <label for="novo_status" class="form-label">Mudar status para:</label>
                        <select class="form-select" name="novo_status" id="novo_status">
                            <option value="Aprovado">Aprovado</option>
                            <option value="Reprovado">Reprovado</option>
                            <option value="Pendente de Correção">Pendente de Correção</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-success w-100">Salvar Alteração</button>
                    </div>
                    <div class="col-12 mt-3">
                        <label for="justificativa" class="form-label">Justificativa</label>
                        <textarea class="form-control" name="justificativa" id="justificativa" rows="2" placeholder="Se reprovado ou pendente, informe o motivo.">{{ empresa.justificativa_status or '' }}</textarea>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Dados do Formulário de Cadastro -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Dados do Formulário de Cadastro</h6>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Protocolo:</dt>
                <dd class="col-sm-9">{{ empresa.protocolo }}</dd>

                <dt class="col-sm-3">Razão Social:</dt>
                <dd class="col-sm-9">{{ empresa.razao_social }}</dd>

                <dt class="col-sm-3">Nome Fantasia:</dt>
                <dd class="col-sm-9">{{ empresa.nome_fantasia }}</dd>

                <dt class="col-sm-3">CNPJ:</dt>
                <dd class="col-sm-9">{{ empresa.cnpj }}</dd>

                <dt class="col-sm-3">Endereço:</dt>
                <dd class="col-sm-9">{{ empresa.endereco }}</dd>

                <dt class="col-sm-3">Telefone:</dt>
                <dd class="col-sm-9">{{ empresa.telefone_empresa }}</dd>

                <dt class="col-sm-3 border-top pt-3 mt-3">Situação Cadastral:</dt>
                <dd class="col-sm-9 border-top pt-3 mt-3">{{ empresa.situacao_cadastral or 'Não informado' }}</dd>

                <dt class="col-sm-3">CNAE Principal:</dt>
                <dd class="col-sm-9">{{ empresa.cnae_principal or 'Não informado' }}</dd>

                <dt class="col-sm-3">CNAEs Secundários:</dt>
                <dd class="col-sm-9">{{ empresa.cnae_secundario or 'Não informado' }}</dd>
            </dl>
        </div>
    </div>

    <!-- SECÇÃO ADICIONADA: Responsáveis -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Responsáveis</h6>
        </div>
        <div class="card-body">
            <h6 class="mb-3">Responsável Jurídico</h6>
            <dl class="row">
                <dt class="col-sm-3">Nome:</dt>
                <dd class="col-sm-9">{{ empresa.responsavel_juridico_nome or 'Não informado' }}</dd>
                <dt class="col-sm-3">CPF:</dt>
                <dd class="col-sm-9">{{ empresa.responsavel_juridico_cpf or 'Não informado' }}</dd>
                <dt class="col-sm-3">Telefone:</dt>
                <dd class="col-sm-9">{{ empresa.responsavel_juridico_tel or 'Não informado' }}</dd>
            </dl>
            <hr>
            <h6 class="mb-3 mt-4">Contador</h6>
            <dl class="row">
                <dt class="col-sm-3">Nome:</dt>
                <dd class="col-sm-9">{{ empresa.contador_nome or 'Não informado' }}</dd>
                <dt class="col-sm-3">CPF:</dt>
                <dd class="col-sm-9">{{ empresa.contador_cpf or 'Não informado' }}</dd>
                <dt class="col-sm-3">Telefone:</dt>
                <dd class="col-sm-9">{{ empresa.contador_tel or 'Não informado' }}</dd>
            </dl>
        </div>
    </div>

    <!-- Horário de Funcionamento -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Horário de Funcionamento</h6>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Segunda-feira:</dt>
                <dd class="col-sm-9">{{ empresa.horario_segunda_feira or 'Não informado' }}</dd>
                
                <dt class="col-sm-3">Terça-feira:</dt>
                <dd class="col-sm-9">{{ empresa.horario_terca_feira or 'Não informado' }}</dd>

                <dt class="col-sm-3">Quarta-feira:</dt>
                <dd class="col-sm-9">{{ empresa.horario_quarta_feira or 'Não informado' }}</dd>

                <dt class="col-sm-3">Quinta-feira:</dt>
                <dd class="col-sm-9">{{ empresa.horario_quinta_feira or 'Não informado' }}</dd>

                <dt class="col-sm-3">Sexta-feira:</dt>
                <dd class="col-sm-9">{{ empresa.horario_sexta_feira or 'Não informado' }}</dd>
                
                <dt class="col-sm-3">Sábado:</dt>
                <dd class="col-sm-9">{{ empresa.horario_sabado or 'Não informado' }}</dd>

                <dt class="col-sm-3">Domingo:</dt>
                <dd class="col-sm-9">{{ empresa.horario_domingo or 'Não informado' }}</dd>

                <dt class="col-sm-3 border-top pt-3 mt-3">Feriados:</dt>
                <dd class="col-sm-9 border-top pt-3 mt-3">{{ 'Sim' if empresa.funciona_feriado == 'sim' else 'Não' }} ({{ empresa.horario_feriado or 'Fechado' }})</dd>
            </dl>
        </div>
    </div>

</div>
{% endblock %}
